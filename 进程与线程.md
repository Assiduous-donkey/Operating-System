# 进程与线程

## 进程

1. 进程的定义有很多，比如：

    - 一个执行中程序的实例

    - 程序在一个数据集上的运行过程

    总之，进程是系统进行资源分配和调度的独立单位。

2. 进程控制块(PCB)，是描述进程的数据结构，且用于进程的管理和调度，**由操作系统维护**。包含以下信息（非全部）：

    - 标识符：包括唯一的进程ID，父进程标识符

    - 进程当前的状态

    - 进程的优先级

    - 程序计数器，保存将被执行的下一条程序指令的地址

    - 内存指针，包括执行程序代码、相关数据和共享内存的指针

    - 上下文数据，即进程被中断时处理器和寄存器中的数据

3. PCB的组织方式有链接式和索引式：

    - 链接式：同一状态的进程的PCB组成一个链表，不同状态对应不同的链表

    - 索引式：同一状态的进程的PCB归入一个索引表，不同状态对应不同的索引表

4. 进程实体是由**程序段、数据段以及进程控制块**等部分组成，称为**进程映像**。具体包括：

    - 用户数据和用户程序

    - 系统栈（跟踪过程调用和过程间参数传递）

    - 进程控制块PCB，由OS维护的用于记录和控制进程属性的集合

5. 进程的创建过程：

    - 建立管理进程的数据结构PCB

    - 为进程分配内存空间

    - 创建进程映像，包括初始化PCB

    - 将进程插入就绪队列

6. 进程的阻塞由进程自身主动执行，进程的唤醒由其他进程执行。

7. 进程切换过程：

    - 保护处理器的上下文环境

    - 更新当前处于运行态的进程的PCB中的控制信息

    - 将该进程插入相应的队列（就绪、阻塞等）

    - 选择一个就绪的进程

    - 更新所选进程的PCB

    - 更新存储管理数据结构

    - 恢复被选中的进程的处理器上下文

## 为什么线程切换的开销比进程切换的开销小

线程存在与进程中，一个进程可以有一个或多个线程。线程的上下文就是进程上下文的子集，故切换时要保存的上下文小，开销自然就小。
